<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Bgy Library, a Zend Framework Extension</title>
<link rel="stylesheet" href="http://borisguery.com/lib/minify/g=bgy-css-min" type="text/css" />
<style type="text/css">
body{text-align:left}
p.post-a-comment {
  text-align: right;
}
</style>
</head>

<body>
<a href="http://github.com/borisguery/bgylibrary"><img
  style="position: absolute; top: 0; right: 0; border: 0;"
  src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
  alt="Fork me on GitHub" /></a>
<div id="container">
<h1><a href="http://github.com/borisguery/bgylibrary">Bgy library</a>
<span class="small">by <a href="http://borisguery.com">Boris
Gu√©ry</a></span></h1>

<p class="description">Extension of Zend Framework Library</p>
<h2>Table of contents</h2>
<ul>
   <li><a href="#bgylib-dependencies">Dependencies</a></li>
   <li><a href="#bgylib-install">Install</a></li>
   <li><a href="#bgylib-components">Components</a>
    <ul>
        <li><a href="#bgylib-components-bgy-application-resource-doctrine2">Bgy_Application_Resource_Doctrine2</a>
            <ul>
              <li><a href="#bgylib-components-bgy-application-resource-doctrine2-overview">Overview</a></li>
              <li><a href="#bgylib-components-bgy-application-resource-doctrine2-configuration">Configuration</a>
                <ul>
                    <li><a href="#bgylib-components-bgy-application-resource-doctrine2-configuration-autoloader">Setting up autoloader</a></li>
                    <li><a href="#bgylib-components-bgy-application-resource-doctrine2-configuration-events">Adding Event Subscribers</a></li>
                </ul>
              </li>
              <li><a href="#bgylib-components-bgy-application-resource-doctrine2-usage">Usage</a>
                <ul>
                    <li><a href="#bgylib-components-bgy-application-resource-doctrine2-usage-web">In your web application</a></li>
                    <li><a href="#bgylib-components-bgy-application-resource-doctrine2-usage-cli">In doctrine-cli-config.php</a></li>
                </ul>
              </li>
            </ul>
        </li>
        <li><a href="#bgylib-components-bgy-controller-plugin-ajaxcontextdefaultformat">Bgy_Controller_Plugin_AjaxContextDefaultFormat</a>
            <ul>
              <li><a href="#bgylib-components-bgy-controller-plugin-ajaxcontextdefaultformat-overview">Overview</a></li>
              <li><a href="#bgylib-components-bgy-controller-plugin-ajaxcontextdefaultformat-configuration">Configuration</a></li>
              <li><a href="#bgylib-components-bgy-controller-plugin-ajaxcontextdefaultformat-usage">Usage</a></li>
            </ul>
        </li>
        <li><a href="#bgylib-components-bgy-dbal-logging-firebug">\Bgy\DBAL\Logging\Firebug</a>
            <ul>
              <li><a href="#bgylib-components-bgy-dbal-logging-firebug-overview">Overview</a></li>
              <li><a href="#bgylib-components-bgy-dbal-logging-firebug-configuration">Configuration</a>
                <ul>
                    <li><a href="#bgylib-components-bgy-dbal-logging-firebug-configuration-resource">Using Bgy_Application_Resource_Doctrine2</a></li>
                    <li><a href="#bgylib-components-bgy-dbal-logging-firebug-configuration-native">Using \Doctrine\DBAL\Configuration</a></li>
                </ul>
              </li>
            </ul>
        </li>
        <li><a href="#bgylib-components-doctrine-entity-serializer">\Bgy\Doctrine\EntitySerializer</a>
            <ul>
              <li><a href="#bgylib-components-bgy-doctrine-entity-serializer-overview">Overview</a></li>
              <li><a href="#bgylib-components-bgy-doctrine-entity-serializer-configuration">Configuration</a></li>
              <li><a href="#bgylib-components-bgy-doctrine-entity-serializer-usage">Usage</a>
                <ul>
                    <li><a href="#bgylib-components-bgy-doctrine-entity-serializer-usage-to-array">Doctrine 2 Entity toArray()</a></li>
                    <li><a href="#bgylib-components-bgy-doctrine-entity-serializer-usage-to-json">Doctrine 2 Entity toJson()</a></li>
                </ul>
              </li>
            </ul>
        </li>
        <li><a href="#bgylib-components-bgy-filter-scheme-http">Bgy_Filter_Scheme_Http</a>
          <ul>
            <li><a href="#bgylib-components-bgy-filter-scheme-http-overview">Overview</a></li>
            <li><a href="#bgylib-components-bgy-filter-scheme-http-configuration">Configuration</a></li>
            <li><a href="#bgylib-components-bgy-filter-scheme-http-usage">Usage</a></li>
          </ul>
        </li>
        <li><a href="#bgylib-components-bgy-filter-hotword">Bgy_Filter_HotWord</a>
            <ul>
               <li><a href="#bgylib-components-bgy-filter-hotword-overview">Overview</a></li>
               <li><a href="#bgylib-components-bgy-filter-hotword-configuration">Configuration</a></li>
               <li><a href="#bgylib-components-bgy-filter-hotword-usage">Usage</a></li>
            </ul>
        <li><a href="#bgylib-components-bgy-filter-slugify">Bgy_Filter_Slugify</a>
            <ul>
              <li><a href="#bgylib-components-bgy-filter-slugify-overview">Overview</a></li>
              <li><a href="#bgylib-components-bgy-filter-slugify-configuration">Configuration</a></li>
              <li><a href="#bgylib-components-bgy-filter-slugify-usage">Usage</a></li>
            </ul>
        </li>
        <li><a href="#bgylib-components-bgy-service-geonames">Bgy_Service_Geonames</a>
            <ul>
              <li><a href="#bgylib-components-bgy-service-geonames-overview">Overview</a></li>
              <li><a href="#bgylib-components-bgy-service-geonames-configuration">Configuration</a></li>
              <li><a href="#bgylib-components-bgy-service-usage">Usage</a>
                  <ul>
                      <li><a href="#bgylib-components-bgy-service-geonames-usage-example">Examples</a></li>
                  </ul>
              </li>
            </ul>
        <li><a href="#bgylib-components-bgy-view-helper-relativedatetime">Bgy_View_Helper_RelativeDateTime</a>
            <ul>
              <li><a href="#bgylib-components-bgy-view-helper-relativedatetime-overview">Overview</a></li>
              <li><a href="#bgylib-components-bgy-view-helper-relativedatetime-configuration">Configuration</a></li>
              <li><a href="#bgylib-components-bgy-view-helper-relativedatetime-usage">Usage</a></li>
            </ul>
        </ul>
        </li>

   <li><a href="#bgylib-license">License</a></li>
  <li><a href="#bgylib-author">Author</a></li>
  <li><a href="#bgylib-download">Download</a></li>
  <li><a href="#bgylib-comments">Comments</a></li>
</ul>

<h2 id="bgylib-dependencies"><a href="#bgylib-dependencies">Dependencies</a></h2>
<p>Zend Framework 1.1x</p>
<h2 id="bgylib-install"><a href="#bgylib-install">Install</a></h2>
<p>Move <span class="filename code boc-nogutter language-plain"><code>Bgy/</code></span> 
 into your <span class="filename code boc-nogutter language-plain"><code>library/</code></span> 
 folder</p>
<p>Register <span class="class code boc-nogutter language-php"><code>Bgy_</code></span> 
 namespace to your autoloader</p>
<pre><code class="brush: ini; code language-ini">
autoloaderNamespaces[] = "Bgy_"
</code></pre>
<h2 id="bgylib-components"><a href="#bgylib-components">Components</a></h2>
<h3 id="bgylib-components-bgy-application-resource-doctrine2"><a href="#bgylib-components-bgy-application-resource-doctrine2">Bgy_Application_Resource_Doctrine2</a></h3>
<h4 id="bgylib-components-bgy-application-resource-doctrine2-overview"><a href="#bgylib-components-bgy-application-resource-doctrine2-overview">Overview</a></h4>
<p>This resource aims to provide a easy way to configure and use Doctrine 2 within 
a Zend Framework 1.1x project.</p>
<p>It allows you to retrieve a 
 <span class="class code boc-nogutter language-php"><code>Doctrine\ORM\Configuration</code></span> 
 object and/or an instance of 
 <span class="class code boc-nogutter language-php"><code>\Doctrine\ORM\EntityManager</code></span>.</p>
<p>You can use it to configure your application or the command line tools provided by Doctrine.</p>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>
<h4 id="bgylib-components-bgy-application-resource-doctrine2-configuration"><a href="#bgylib-components-bgy-application-resource-doctrine2-configuration">Configuration</a></h4>
<p>Here is a sample <span class="filename code boc-nogutter language-plain"><code>application.ini</code></span> 
 with available options</p>
<pre><code class="brush: ini; code language-ini">
[production]
pluginpaths.Bgy_Application_Resource = "Bgy/Application/Resource" ; Add custom resource
resources.doctrine2.proxy.dir = APPLICATION_PATH "/proxies"
resources.doctrine2.proxy.autoGenerateClasses = false
resources.doctrine2.proxy.namespace = "\App\Models\Proxies"
resources.doctrine2.metadata.driver = "annotation"
resources.doctrine2.metadata.paths[] = APPLICATION_PATH "/models/Entities/"
resources.doctrine2.cache.result = "\Doctrine\Common\Cache\ArrayCache"
resources.doctrine2.cache.query = "\Doctrine\Common\Cache\ArrayCache"
resources.doctrine2.cache.metadata = "\Doctrine\Common\Cache\ArrayCache"
resources.doctrine2.options.useCExtention = false
resources.doctrine2.options.sqlLogger = "\Doctrine\DBAL\Logging\EchoSQLLogger"
resources.doctrine2.params.driver = "pdo_mysql"
resources.doctrine2.params.dbname = "bgy"
resources.doctrine2.params.host = "127.0.0.1"
resources.doctrine2.params.port = 3306
resources.doctrine2.params.user = "root"
resources.doctrine2.params.password = ""
resources.doctrine2.hydrators.customHydrator = "\Doctrine\ORM\Internal\Hydration\ObjectHydrator"
resources.doctrine2.types.datetime = "Bgy\DBAL\Types\MyDateTimeType"
;resources.doctrine2.events.eventManager = "\Doctrine\Common\EventManager"
;resources.doctrine2.events.subscribers.mysqlSessionInitDefaultParameters = "\Doctrine\DBAL\Event\Listeners\MysqlSessionInit"
resources.doctrine2.events.subscribers.mysqlSessionInit.className = "\Doctrine\DBAL\Event\Listeners\MysqlSessionInit"
resources.doctrine2.events.subscribers.mysqlSessionInit.charset = "UTF8"

[development : production]
resources.doctrine2.proxy.autoGenerateClasses = true
</code></pre>
<p>Some options are mandatory while others are optional, please refer to the 
 <a href="http://www.doctrine-project.org/docs/orm/2.0/en/reference/configuration.html">Doctrine 
2 manual.</a></p>
<h5 id="bgylib-components-bgy-application-resource-doctrine2-configuration-autoloader"><a href="#bgylib-components-bgy-application-resource-doctrine2-configuration-autoloader">Setting up autoloader</a></h5>
<p>In order to use the autoloader, you need to register the 
<span class="class code boc-nogutter language-php"><code>Doctrine</code></span> namespace.
<br />
In your <span class="filename code boc-nogutter language-plain"><code>application.ini</code></span>:
</p>
<pre><code class="brush: php; code language-php">
autoloaderNamespaces[] = "Doctrine"
</code></pre>
<p class="note"><em>Note:</em> You don't need to append '_' (underscore) to the 
 pseudo-namespace because Doctrine actually use PHP 5.3 namespace.
</p>
<p>Be sure to set up your include path accordingly to your project.<br />
 The most convenient way is to place <span class="filename code boc-nogutter language-plain"><code>Doctrine/ORM</code></span>, 
 <span class="filename code boc-nogutter language-plain"><code>Doctrine/Common</code></span>, 
 <span class="filename code boc-nogutter language-plain"><code>Doctrine/DBAL</code></span> and
 <span class="filename code boc-nogutter language-plain"><code>Symfony/*</code></span> 
 under <span class="filename code boc-nogutter language-plain"><code>library/</code></span>.
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h5 id="bgylib-components-bgy-application-resource-doctrine2-configuration-events"><a href="#bgylib-components-bgy-application-resource-doctrine2-configuration-events">Adding Event Subscribers</a></h5>
<p>Let's say you are using MySQL and you want to init your connection by setting 
the charset to UTF-8. In plain old (My)SQL you achieve this by querying the 
following statement: 
<span class="statement code boc-nogutter language-sql"><code>SET NAMES 'UTF8'</code></span>.
<br />Doctrine 2 already provides such thing within 
<span class="classname code boc-nogutter language-plain"><code>\Doctrine\DBAL\Event\Listeners\MysqlSessionInit</code></span>.
<br />In order to use it, you need to add it to an 
<span class="classname code boc-nogutter language-plain"><code>EventManager</code></span>:
</p>
<pre><code class="brush: ini; code language-php">
use \Doctrine\Common,
    \Doctrine\DBAL\Event\Listeners;
$eventManager = new EventManager();
$eventManager->addEventSubscriber(new MysqlSessionInit('UTF8'));
</code></pre>
Using the <span class="classname code boc-nogutter language-plain"><code>\Bgy\Application\Resource\Doctrine2</code></span>,
 you only need to do this:
<pre><code class="brush: ini; code language-ini boc-first-line[21]">
;resources.doctrine2.events.eventManager = "\Doctrine\Common\EventManager"
;resources.doctrine2.events.subscribers.mysqlSessionInitDefaultParameters = "\Doctrine\DBAL\Event\Listeners\MysqlSessionInit"
resources.doctrine2.events.subscribers.mysqlSessionInit.className = "\Doctrine\DBAL\Event\Listeners\MysqlSessionInit"
resources.doctrine2.events.subscribers.mysqlSessionInit.charset = "UTF8"
</code></pre>

<p>You don't need to specify an <span class="classname code boc-nogutter language-plain"><code>EventManager</code></span>
if you want to use the default provided by Doctrine 2.</p>
<p>If you need to provide arguments to the subscriber, you can use the ini array
 notation as showed in the example above. In this case, you <strong>must</strong>
 provide a <span class="code boc-nogutter language-plain"><code>className</code></span>
  option with the actual class name. You can then use either indexed or named keys.
 </p>

<h4 id="bgylib-components-bgy-application-resource-doctrine2-usage"><a href="#bgylib-components-bgy-application-resource-doctrine2-usage">Usage</a></h4>
<h5 id="bgylib-components-bgy-application-resource-doctrine2-usage-web"><a href="#bgylib-components-bgy-application-resource-doctrine2-usage-web">In your web application</a></h5>
<pre><code class="brush: php; code language-php">
$bootstrap = $this->getInvokeArg('bootstrap');
if ($bootstrap->hasResource('doctrine2')) {
    $doctrine2Resource = $bootstrap->getResource('doctrine2');
    $em = $doctrine2Resource->getEntityManager();
}
</code></pre>
<p>You can now store the <span class="class code boc-nogutter language-php"><code>EntityManager</code></span> in the 
 <span class="class code boc-nogutter language-php"><code>Registry</code></span>, 
 or use it through a <span class="class code boc-nogutter language-php"><code>Service</code></span>.
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h5 id="bgylib-components-bgy-application-resource-doctrine2-usage-cli"><a href="#bgylib-components-bgy-application-resource-doctrine2-usage-cli">In doctrine-cli-config.php</a></h5>
<pre><code class="brush: php; code language-php">
// Include paths, require, constants definition, etc.
$application = new Zend_Application(
    APPLICATION_ENV,
    APPLICATION_PATH . '/configs/application.ini'
);

$application->getBootstrap()
    ->bootstrap(array('doctrine2'));

$em = $application->getBootstrap()
    ->getResource('doctrine2')
    ->getEntityManager();

$GLOBALS['helperSet'] = new \Symfony\Component\Console\Helper\HelperSet(
    array(
        'db' => new \Doctrine\DBAL\Tools\Console\Helper\ConnectionHelper($em->getConnection()),
        'em' => new \Doctrine\ORM\Tools\Console\Helper\EntityManagerHelper($em)
    )
);
</code></pre>
<p>Change the path of the config file in the <span class="filename code boc-nogutter language-plain"><code>doctrine.php</code></span> cli scripts :</p>
<pre><code class="brush: php; code language-php">
$configFile = getcwd() . DIRECTORY_SEPARATOR . 'configs/doctrine-cli-config.php';
</code></pre>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h3 id="bgylib-components-bgy-dbal-logging-firebug"><a href="#bgylib-components-bgy-dbal-logging-firebug">\Bgy\DBAL\Logging\Firebug</a></h3>
<h4 id="bgylib-components-bgy-dbal-logging-firebug-overview"><a href="#bgylib-components-bgy-dbal-logging-firebug-overview">Overview</a></h4>
<p><span class="classname code boc-noguttr language-php">\Bgy\DBAL\Logging\Firebug</span> is an utility to profile Doctrine 2 SQL queries with Firebug/FirePHP.<br />
It is now really an extension to Zend Framework, as it implements <span class="classname code boc-noguttr language-php"><code>\Doctrine\DBAL\Logging\SQLLogger</code></span> but makes
use of <span class="classname code boc-noguttr language-php">Zend_Wildfire</span> component, and is part of the <strong>Zend Framework Doctrine 2 Integration</strong>.</p>
<h4 id="bgylib-components-bgy-dbal-logging-firebug-configuration"><a href="#bgylib-components-bgy-dbal-logging-firebug-configuration">Configuration</a></h4>
<h5 id="bgylib-components-bgy-dbal-logging-firebug-configuration-resource"><a href="#bgylib-components-bgy-dbal-logging-firebug-configuration-resource">Using Bgy_Application_Resource_Doctrine2</a></h5>
<p>By default, now logger are used by Doctrine 2, to use this custom logger, 
specify its classname in your 
<span class="filename code boc-nogutter language-plain"><code>config.ini</code></span>.
Look at the highlighted line :</p>
<pre><code class="code language-ini boc-highlight[12]">
[production]
pluginpaths.Bgy_Application_Resource = "Bgy/Application/Resource"
resources.doctrine2.proxy.dir = APPLICATION_PATH "/proxies"
resources.doctrine2.proxy.autoGenerateClasses = false
resources.doctrine2.proxy.namespace = "\App\Models\Proxies"
resources.doctrine2.metadata.driver = "annotation"
resources.doctrine2.metadata.paths[] = APPLICATION_PATH "/models/Entities/"
resources.doctrine2.cache.result = "\Doctrine\Common\Cache\ArrayCache"
resources.doctrine2.cache.query = "\Doctrine\Common\Cache\ArrayCache"
resources.doctrine2.cache.metadata = "\Doctrine\Common\Cache\ArrayCache"
resources.doctrine2.options.useCExtention = false
resources.doctrine2.options.sqlLogger = "\Bgy\DBAL\Logging\Firebug"
resources.doctrine2.params.driver = "pdo_mysql"
resources.doctrine2.params.dbname = "bgy"
resources.doctrine2.params.host = "127.0.0.1"
resources.doctrine2.params.port = 3306
resources.doctrine2.params.user = "root"
resources.doctrine2.params.password = ""
</code></pre>
<h5 id="bgylib-components-bgy-dbal-logging-firebug-configuration-native"><a href="#bgylib-components-bgy-dbal-logging-firebug-configuration-native">Using \Doctrine\DBAL\Configuration</a></h5>
<p>If you don't want to use the custom resource, you can still use this logger by using 
the <span class="classname code boc-nogutter language-plain"><code>Doctrine\Configuration</code></span>
<span class="method code boc-nogutter language-plain"><code>setSQLLogger()</code></span> setter method.</p>
<pre><code class="brush: php; code language-php">
use \Doctrine\Configuration,
    \Bgy\DBAL\Logging;
    
$config = new Configuration();
$config->setSQLLogger(new Firebug());
</code></pre>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h3 id="bgylib-components-bgy-doctrine-entity-serializer"><a href="#bgylib-components-bgy-doctrine-entity-serializer">\Bgy\Doctrine\EntitySerializer</a></h3>
<h4 id="bgylib-components-bgy-doctrine-entity-serializer"><a href="#bgylib-components-bgy-doctrine-entity-serializer-overview">Overview</a></h4>
<p><span class="classname code boc-noguttr language-php">\Bgy\Doctrine\EntitySerializer</span> is an utility inspired by the <a href="https://gist.github.com/1034079#file_serializable_entity.php">Doctrine 2 Traits preview</a> 
from Benjamin Eberlei.</p>
<p>Traits are currently "available" in PHP 5.4 only, I decided to write this component because I was not able to find a clever way to serialize an Entity Object to an Array.
<br />
We can use an Array Result as well as writing a custom hydrator, but in some case we just need to cast such object and its relationship to an Array. 
Most solutions I found until now implemented such serialization in the Entity itself, adding then a dependency to the Entity Manager and therefore the Persistence Layer,
which is actually one of the best improvement of Doctrine 2.<br /> 
The idea behind this component is to be used as a Service which will be used to serialize an Entity.
</p>
<h4 id="bgylib-components-bgy-doctrine-entity-serializer-configuration"><a href="#bgylib-components-bgy-doctrine-entity-serializer-configuration">Configuration</a></h4>
<p>There are no configuration needed except to set up the <span class="method code boc-nogutter language-plain"><code>EntityManager</code></span>
 using either the constructor or the <span class="method code boc-nogutter language-plain"><code>setEntityManager()</code></span> setter method.</p>
<h4 id="bgylib-components-bgy-doctrine-entity-serializer-usage"><a href="#bgylib-components-bgy-doctrine-entity-serializer-usage">Usage</a></h4>
<h5 id="bgylib-components-bgy-doctrine-entity-serializer-usage-to-array"><a href="#bgylib-components-bgy-doctrine-entity-serializer-usage-to-array">toArray()</a></h5>
<p>
Let's say you are using some sort of Dependency Injection and Service Locator, you will have:</p>
<pre><code class="code language-php">
public function getEntitySerializerService()
{
    if (!isset(self::$shared['entitySerializer']])) {
        self::$shared['entitySerializer'] = new Bgy\Doctrine\EntitySerializer(
            $this->getEntityManagerService()
        );
    }
    
    return self::$shared['entitySerializer'];
}
</code></pre>
<p>Then, for example in your Controller:</p>
<pre><code class="code language-php">
public function toArrayAction()
{
    $user = $serviceLocator->getEntityManager()->find('Entity\User', 1);
    $user = $serviceLocator->getEntitySerializer()->toArray($user);
    
    // Do something here
}
</code></pre>
<h5 id="bgylib-components-bgy-doctrine-entity-serializer-usage-to-json"><a href="#bgylib-components-bgy-doctrine-entity-serializer-usage-to-json">toJson()</a></h5>
<p>Serialization to JSON is pretty straightfoward, it is similar to the <span class="method code boc-nogutter language-plain"><code>toArray()</code> method.</span>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h3 id="bgylib-components-bgy-controller-plugin-ajaxcontextdefaultformat"><a href="#bgylib-components-bgy-controller-plugin-ajaxcontextdefaultformat">Bgy_Controller_Plugin_AjaxContextDefaultFormat</a></h3>
<h4 id="bgylib-components-bgy-controller-plugin-ajaxcontextdefaultformat-overview"><a href="#bgylib-components-bgy-controller-plugin-ajaxcontextdefaultformat-overview">Overview</a></h4>
<p>This plugin allows you to define a defaut format when using the AjaxContext View Helper.<br />
<p>When using AjaxContext, you need to specify a format to tell the controller which view to return.<br />
<br />For example, in a view script:</p>
<pre><code class="brush: php; code language-php">
$this->url(array(
    'controller' => 'index',
    'action'     => 'delete',
    'id'         => 1,
    'format'     => 'json',    
), null, true);
</code></pre>
<p>Zend doesn't check for an Ajax request, instead it uses the format parameter.<br />
Basicly, this plugin check for an XHR request, and set a defaut format (default to 'JSON').<br />
However, you can still override the format parameter when necessary.</p>

<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>


<h4 id="bgylib-components-bgy-controller-plugin-ajaxcontextdefaultformat-configuration"><a href="#bgylib-components-bgy-controller-plugin-ajaxcontextdefaultformat-configuration">Configuration</a></h4>
<p>In your <span class="filename code boc-nogutter language-plain"><code>Bootstrap.php</code></span>, place the following code:</p>
<pre><code class="brush: php; code language-php">
protected function _initPlugins()
{
    $this->bootstrap('frontController');
    $front = $this->getResource('frontController');
    $front->registerPlugin(new Bgy_Controller_Plugin_AjaxContextDefaultFormat('json'));
}
</code></pre>
<p>If you don't provide a default format, JSON is used.</p>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>


<h4 id="bgylib-components-bgy-controller-plugin-ajaxcontextdefaultformat-usage"><a href="#bgylib-components-bgy-controller-plugin-ajaxcontextdefaultformat-usage">Usage</a></h4>
<p>None</p>

<h3 id="bgylib-components-bgy-filter-scheme-http"><a href="#bgylib-components-bgy-filter-scheme-http">Bgy_Filter_Scheme_Http</a></h3>
<h4 id="bgylib-components-bgy-filter-scheme-http-overview"><a href="#bgylib-components-bgy-filter-scheme-http-overview">Overview</a></h4>
<p>Bgy_Filter_Scheme_Http prepends the <span class="code">http://</span> scheme to 
a given string. <br />It replaces the current scheme if it is already present 
 and/or malformed before to prepend</p>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h4 id="bgylib-components-bgy-filter-scheme-http-configuration"><a href="#bgylib-components-bgy-filter-scheme-http-configuration">Configuration</a></h4>
<p>There is no configuration for this extension</p>
<h4 id="bgylib-components-bgy-filter-scheme-http-usage"><a href="#bgylib-components-bgy-filter-scheme-http-usage">Usage</a></h4>
<pre><code class="brush: php; code language-php boc-no-auto-links">
$urls = array(
    'borisguery.com',
    'http://borisguery.com',
    'ftp://borisguery.com',
    'htp://borisguery.com',
    'http:/borisguery.com',
    'http:borisguery.com',
);
$filter = new Bgy_Filter_Scheme_Http();
foreach ($urls as $url) {
    var_dump($filter->filter($url));
}
</code></pre>
<p>All <span class="variable">$url</span> return <span class="string">http://borisguery.com</span></p>

<p>However, the following example returns 'http://httpborisguery.com' because
 it has no way to determine if 'http' is part of the domain or not</p>
<pre><code class="brush: php; code language-php">
$filter->filter('httpborisguery.com');
</code></pre>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>


<h3 id="bgylib-components-bgy-filter-hotword"><a href="#bgylib-components-bgy-filter-hotword">Bgy_Filter_HotWord</a></h3>
<h4 id="bgylib-components-bgy-filter-hotword-overview"><a href="#bgylib-components-bgy-filter-hotword-overview">Overview</a></h4>
<p>The main goal of this filter is to wrap a keyword into an html element.</p> 
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h4 id="bgylib-components-bgy-filter-hotword-configuration"><a href="#bgylib-components-bgy-filter-hotword-configuration">Configuration</a></h4>
<pre><code class="brush: php; code language-php">
$filter = new Bgy_Filter_HotWord();
$filter->setKeywords(array(
    'consectetur',
    'rhoncus commodo',
    'sollicitudin',
    'dapibus',
    'rhoncus',
));
$filter->setWrapper('<strong>%string%</strong>');
</code></pre>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h4 id="bgylib-components-bgy-filter-hotword-usage"><a href="#bgylib-components-bgy-filter-hotword-usage">Usage</a></h4>
<p>Using the previous configuration, let's say we have the following text:</p>
<pre><code class="brush: php; code language-php">
$text = 'Lorem ipsum dolor sit amet, consectetur rhoncus adipiscing elit. '
 . 'Vestibulum dapibus tortor rhoncus rhoncus commodo fermentum erat gravida '
 . 'sollicitudin. Ut magna diam, tincidunt ac dapibus id, placerat at arcu. '
 . 'Mauris a sapien sit amet risus auctor venenatis et consequat urna. '
 . 'Pellentesque orci erat, gravida vitae rhoncus commodo, laoreet in ipsum. ';
</code></pre>

<p>The filtered text will looks like this:</p>
<pre><code class="brush: html; code language-html">
Lorem ipsum dolor sit amet, <strong>consectetur</strong> <strong>rhoncus</strong>
 adipiscing elit. Vestibulum <strong>dapibus</strong> tortor 
 <strong>rhoncus</strong> <strong>rhoncus commodo</strong> fermentum erat 
 gravida <strong>sollicitudin</strong>. Ut magna diam, tincidunt ac 
 <strong>dapibus</strong> id, placerat at arcu. Mauris a sapien sit amet 
 risus auctor venenatis et consequat urna. Pellentesque orci erat, gravida 
 vitae <strong>rhoncus commodo</strong>, laoreet in ipsum. 
</code></pre>
<p class="note"><em>Note:</em> Keywords can be either a word or a word sequence.
The longest word sequence found will be used first, and won't be wrapped twice if it 
matches a shorter and similar keywords. <br />Look at the 
<span class="keyword">rhoncus</span> and <span class="keyword">rhoncus commodo</span> keywords for an example.
</p>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h3 id="bgylib-components-bgy-filter-slugify"><a href="#bgylib-components-bgy-filter-slugify">Bgy_Filter_Slugify</a></h3>
<h4 id="bgylib-components-bgy-filter-slugify-overview"><a href="#bgylib-components-bgy-filter-slugify-overview">Overview</a></h4>
<p><span class="class code boc-nogutter language-php"><code>Bgy_Filter_Slugify</code></span> 
 helps you to generate slugs.<br />
 Slugs are normalized string free of specials charaters, it is commonly used to 
 generate permalink or product reference.
</p>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h4 id="bgylib-components-bgy-filter-slugify-configuration"><a href="#bgylib-components-bgy-filter-slugify-configuration">Configuration</a></h4>
<p>There are three optional options for this filter:</p>
<pre><code class="brush: php; code language-php">
$options = array(
    'separator' => '~',     // default to '-' (dash)
    'lowercase' => false,   // default to true
    'maxlength' => 35,     // default to null (no maxlength)
);
</code></pre>
<p>You can either provide, an array, a Zend_Config object or function arguments 
in the same given order.
<br />
Example:
</p>
<pre><code class="brush: php; code language-php">
$filter = new Bgy_Filter_Slugify('~', false, 35);
</code></pre>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h4 id="bgylib-components-bgy-filter-slugify-usage"><a href="#bgylib-components-bgy-filter-slugify-usage">Usage</a></h4>
<p>Using the previous configuration, the filtered value returns:</p>
<pre><code class="brush: php; code language-php boc-no-auto-links">
$value = 'http://√üorisGu√©ry.Gith√ºB.com/BgyLibr√§ry/';
echo $filter->filter($value);

// returns (note the (√ü) Eszett and others accented charaters)

'http~ssorisGuery~GithuB~com~BgyLibr'
</code></pre>

<p class="note"><em>Note:</em> The length is computed <strong>after</strong> the string 
being slugified, and if a separator is present at the end of the string, it is trimed.
Therefore, the resulting length may be different.</p>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>


<h3 id="bgylib-components-bgy-service-geonames"><a href="#bgylib-components-bgy-service-geonames">Bgy_Service_Geonames</a></h3>
<h4 id="bgylib-components-bgy-service-geonames-overview"><a href="#bgylib-components-bgy-service-geonames-overview">Overview</a></h4>
<p>Geonames is a geographical database and webservice free of charge under a 
 creative commons attribution license. To know more about Geonames, visit their 
 <a href="http://www.geonames.org/about.html">website</a>.<p>
<p>Bgy_Service_Geonames is a webservice wrapper which respects the Zend Framework</p>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h4 id="bgylib-components-bgy-service-geonames-configuration"><a href="#bgylib-components-bgy-service-geonames-configuration">Configuration</a></h4>
<p class="note"><em>Note:</em> According to this 
<a href="http://geonames.wordpress.com/2011/01/28/application-identification-for-free-geonames-web-services/">announcement</a>
the username is now mandatory (if you use the new URI: api.geonames.org)</p>
<p>To configure your username and token, you can pass an array, or an instance of 
<span class="class code boc-nogutter language-php"><code>Zend_Config</code></span> 
 to the constructor: </p>
<pre><code class="brush: php; code language-php">
$options = array(
    'username' => 'borisguery',
    'token'    => 'abcdef0123456789'
);
$g = new Bgy_Service_Geonames($options);
</code></pre>
Alternatively you can set both with their respective setters:
<pre><code class="brush: php; code language-php">
$g = new Bgy_Service_Geonames();
$g->setUsername('borisguery')
    ->setToken('abcdef0123456789');
</code></pre>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h4 id="bgylib-components-bgy-service-usage"><a href="#bgylib-components-bgy-service-usage">Usage</a></h4>
<p>Most of <a href="http://www.geonames.org/export/ws-overview.html">the methods</a>
 provided by the Geonames webservices are available.<br /><br />
The following static method returns a complete list of the supported methods:
 </p>
<pre><code class="brush: php; code language-php">
Bgy_Service_Geonames::getAvailableMethods();
</code></pre>

<p><span class="class code boc-nogutter language-php"><code>Bgy_Service_Geonames</code></span>
uses the magic method <span class="class code boc-nogutter language-php"><code>__call()</code></span>
 therefore all methods have the same signature.</p>
<pre><code class="brush: php; code language-php">
/**
 * @method array postalCodeCountryInfo()      postalCodeCountryInfo(array $params)
 * @method array postalCodeLookup()           postalCodeLookup(array $params)
 */
</code></pre>

<p>For a complete list of the available and mandatory parameters, see the
<a href="http://www.geonames.org/export/web-services.html">Geonames webservice manual</a>.
</p>

<p>Errors are also handled by the wrapper, and throw a 
<span class="class code boc-nogutter language-php"><code>Bgy_Service_Geonames_Exception</code></span>
with the message returned by the webservice.<br />
See the <a href="http://www.geonames.org/export/webservice-exception.html">manual</a> for a description of the errors.</p>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h5 id="bgylib-components-bgy-service-geonames-usage-example"><a href="#bgylib-components-bgy-service-geonames-usage-example">Examples</a></h5>
<p>Retrieve informations for a given postal code</p>
<pre><code class="brush: php; code language-php">
$result = $g->postalCodeLookup(
    array(
      'postalcode' => '13100',
      'country'    => 'FR',
      'maxRows'    => 1,
    )
);

// returns

array
  0 => 
    array
      'adminCode3' => string '131' (length=3)
      'adminName2' => string 'Bouches-du-Rh√¥ne' (length=17)
      'adminName3' => string 'Arrondissement d'Aix-en-Provence' (length=32)
      'adminCode2' => string '13' (length=2)
      'postalcode' => string '13100' (length=5)
      'adminCode1' => string 'B8' (length=2)
      'countryCode' => string 'FR' (length=2)
      'lng' => float 5.55
      'placeName' => string 'Beaurecueil' (length=11)
      'lat' => float 43.5
      'adminName1' => string 'Provence-Alpes-C√¥te d'Azur' (length=27)
</code></pre>

<p>Retrieve informations for a given postal code</p>
<pre><code class="brush: php; code language-php">
$result  = $g->findNearbyPlaceName(
    array(
      'lng'     => 5.55,
      'lat'     => 43.5,
      'lang'    => 'FR',
      'style'   => 'short',
      'maxRows' => 2,
      'radius'  => 10,
    )
);

// returns

array
  0 => 
    array
      'distance' => string '1.36754' (length=7)
      'toponymName' => string 'Beaurecueil' (length=11)
      'fcl' => string 'P' (length=1)
      'name' => string 'Beaurecueil' (length=11)
      'countryCode' => string 'FR' (length=2)
      'lng' => float 5.5456924438477
      'fcode' => string 'PPL' (length=3)
      'geonameId' => int 3034099
      'lat' => float 43.511895697594
  1 => 
    array
      'distance' => string '1.94964' (length=7)
      'toponymName' => string 'Ch√¢teauneuf-le-Rouge' (length=21)
      'fcl' => string 'P' (length=1)
      'name' => string 'Ch√¢teauneuf-le-Rouge' (length=21)
      'countryCode' => string 'FR' (length=2)
      'lng' => float 5.5692100524902
      'fcode' => string 'PPL' (length=3)
      'geonameId' => int 3026229
      'lat' => float 43.489358035839

</code></pre>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h3 id="bgylib-components-bgy-view-helper-relativedatetime"><a href="#bgylib-components-bgy-view-helper-relativedatetime">Bgy_View_Helper_RelativeDateTime</a></h3>
<h4 id="bgylib-components-bgy-view-helper-relativedatetime-overview"><a href="#bgylib-components-bgy-view-helper-relativedatetime-overview">Overview</a></h4>
<p>Bgy_View_Helper provides a efficient and configurable way to generate a relative
 date/time string from a given Zend_Date object.</p>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

 
<h4 id="bgylib-components-bgy-view-helper-relativedatetime-configuration"><a href="#bgylib-components-bgy-view-helper-relativedatetime-configuration">Configuration</a></h4>
<p>First you need to set up your <span class="class code boc-nogutter language-php"><code>View</code></span> object to 
use your custom View Helper. <br />
Somewhere in your <span class="filename code boc-nogutter language-plain"><code>Bootstrap.php</code></span>:
</p>

<pre><code class="brush: php; code language-php">
$this->bootstrap('view');
$view = $this->getResource('view');
$view->addHelperPath(
    APPLICATION_PATH . '/../library/Bgy/View/Helper',
    'Bgy_View_Helper_'
);
</code></pre>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>


<h4 id="bgylib-components-bgy-view-helper-relativedatetime-usage"><a href="#bgylib-components-bgy-view-helper-relativedatetime-usage">Usage</a></h4>
<p>Let's say we have the following dates string, and current date is 2011-02-22T:20:59:15. <br />
In your view scripts:</p>
<pre><code class="brush: php; code language-php">
$relativeDateTime = new Bgy_View_Helper_RelativeDateTime();
$dates = array(
    '2010-01-01',
    '2010-06-01',
    '2010-12-01',
    '2011-02-01',
    '2011-02-20',
    '2011-02-22T19:50',
    '2011-02-22T20:58',
    '2011-02-22T20:59:12',
);
$dates = array_map(function($a){return new Zend_Date($a);}, $dates);
        
foreach ($dates as $date) {
    echo $relativeDateTime->relativeDateTime($date) . '<br />';
}
</code></pre>

<p>The following code returns:</p>
<pre><code class="code language-plain">
1 year
8 months
2 months
3 weeks
2 days
1 hour
19 minutes
1 minute
3 seconds
</code></pre>

<p>Now if we want to change the way the result will be formated, we can use the following method
<span class="method code boc-nogutter language-php"><code>setUnitTemplate($unitKey, $template)</code></span>  
 and <span class="method code boc-nogutter language-php"><code>setUnitTemplates(array $templates)</code></span></p>
<p>Here is an example using the previous code:</p>
<pre><code class="brush: php; code language-php">
$relativeDateTime = new Bgy_View_Helper_RelativeDateTime();
$relativeDateTime->setUnitTemplate(Bgy_View_Helper_RelativeDateTime::DAYS, 'there are %value% days ago');
</code></pre>
<p>Alternatively you can do:</p>
<pre><code class="brush: php; code language-php">
$relativeDateTime = new Bgy_View_Helper_RelativeDateTime();
$templates = array(
    Bgy_View_Helper_RelativeDateTime::DAYS => 'there are %value% days ago',
);
$relativeDateTime->setUnitTemplates($templates);
</code></pre>

<p>returns:</p>
<pre><code class="code language-plain">
there are 2 days
</code></pre>

<p>The helper use <span class="class code boc-nogutter language-php"><code>Zend_View_Helper_Translate</code></span>
 which means you can translate your template in your prefered translate format (either CSV, gettext, XML, etc.) and they'll
 be translated automatically.</p>
<p class="post-a-comment"><a href="#bgylib-comments">Comment</a></p>

<h2 id="bgylib-license"><a href="#bgylib-license">License</a></h2>
<pre>            DO WHAT THE FUCK YOU WANT TO PUBLIC LICENSE
                    Version 2, December 2004

 Copyright (C) 2004 Sam Hocevar &laquo;sam@hocevar.net&raquo;

 Everyone is permitted to copy and distribute verbatim or modified
 copies of this license document, and changing it is allowed as long
 as the name is changed.

            DO WHAT THE FUCK YOU WANT TO PUBLIC LICENSE
   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION

  0. You just DO WHAT THE FUCK YOU WANT TO. </pre>
<h2 id="bgylib-author"><a href="#bgylib-author">Author</a></h2>
<p>Boris Gu√©ry (guery.b@gmail.com)</p>

<h2 id="bgylib-download"><a href="#bgylib-download">Download</a></h2>
<p>You can download this project in either <a
  href="http://github.com/borisguery/bgylibrary/zipball/master">zip</a>
or <a href="http://github.com/borisguery/bgylibrary/tarball/master">tar</a>
formats.</p>
<p>You can also clone the project with <a href="http://git-scm.com">Git</a>
by running:</p>
<pre>$ git clone git://github.com/borisguery/bgylibrary</pre>


<div class="footer">get the source code on GitHub : <a
  href="http://github.com/borisguery/bgylibrary">borisguery/bgylibrary</a>
</div>

<h2 id="bgylib-comments"><a href="#bgylib-comments">Comments</a></h2>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'borisgueryassembly';
    var disqus_identifier = 'bgylibrary';
    var disqus_url = 'http://borisguery.github.com/bgylibrary';
    var disqus_developer = 1;
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


</div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript" src="scripts/jquery.beautyOfCode-min.js"></script>
<script type="text/javascript">
$(document).ready(function() {
      $.beautyOfCode.init({
          brushes: ['Plain', 'Php', 'Xml', 'Sql'],
          ready: function() {
              $.beautyOfCode.utils.loadScript('scripts/syntaxhighlighter/shBrushIni.js', function(){$.beautyOfCode.beautifyAll();});
          }
      });
  });
</script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-21610741-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>
